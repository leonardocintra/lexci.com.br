{% extends "core/base.html" %}

{% load exame_extras %}

{% block content %}
    <ol class="breadcrumb">
        <li><a href="{% url 'management' %}">Admin Lexci</a></li>
        <li><a href="{% url 'paciente:paciente_list' %}">Pacientes</a></li>
        <li><a href="{% url 'paciente:paciente_detail' laudo.paciente.id %}">{{ laudo.paciente.nome }}</a></li>
        <li><a href="{% url 'laudo:laudo_detalhe' laudo.id %}">Laudo #{{ laudo.id }}</a></li>
        <li class="active">Detalhes do Laudo #{{ laudo.id }} </li>
    </ol>
    <div class="page-header">
        <h3>Corrigir exame de {{ laudo.paciente.nome }} <small>Laudo #{{ laudo.id }}</small> </h3>
    </div>

    <form action="" method="post">
        {% csrf_token %}

        {# Exibe as informações do Paciente#}
        {% include "laudo/includes/paciente_include.html" %}

        {{ form_urina_rotina.management_form }}

        <div class="col-sm-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
                        Características Físicas
                    </h3>
                </div>                

                <div class="panel-body">
                    <div class="form-horizontal">

                        {% for form in form_urina_rotina %}
                            <div class="form-group">
                                <label class="col-sm-2 control-label">{{ form.volume.label }}</label>
                                {{ form.volume }}
                            </div>
                        {% endfor %}

                        {% for exame in exames_caracteristicas_fisicas %}
                            <div class="form-group">
                                <label class="col-sm-2 control-label">{{ exame }}</label>
                                {% for item in item_exame_caracteristicas_fisicas %}
                                    {% if item.exame_id == exame.id %}
                                        <div class="radio-inline">
                                            <label>
                                                <input 
                                                    type="radio" 
                                                    name="item_{{ exame.descricao|replace_nome_exame }}" 
                                                    value="{{ item.id }}"
                                                    {% for item_marcado in exames_marcados %}
                                                        {% if item.id == item_marcado.item_exame.id %}
                                                            checked="checked"
                                                        {% endif %}
                                                    {% endfor %}
                                                > {{ item }}
                                            </label>
                                        </div>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        {% endfor %}

                        {% for form in form_urina_rotina %}
                            {% if forloop.first %}
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">{{ form.ph_urina.label }}</label>
                                    {{ form.ph_urina }}
                                </div>
                            {% endif %}
                        {% endfor %}

                    </div>
                </div>
            </div>
        </div>

        <div class="col-sm-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
                        Características Químicas
                    </h3>
                </div>
                <div class="panel-body">
                    <div class="form-horizontal">
                        {% for exame in exames_caracteristicas_quimicas %}
                            <div class="form-group">
                                <label class="col-sm-2 control-label">{{ exame }}</label>
                                {% for item in item_exame_caracteristicas_quimicas %}
                                    {% if item.exame_id == exame.id %}
                                        <div class="radio-inline">
                                            <label>
                                                <input 
                                                    type="radio" 
                                                    name="item_{{ exame.descricao|replace_nome_exame }}" 
                                                    value="{{ item.id }}"
                                                    {% for item_marcado in exames_marcados %}
                                                        {% if item.id == item_marcado.item_exame.id %}
                                                            checked="checked"
                                                        {% endif %}
                                                    {% endfor %}
                                                > {{ item }}
                                            </label>
                                        </div>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        <div class="col-sm-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
                        Análise microscópica do sedimento
                    </h3>
                </div>
                <div class="panel-body">
                    <div class="form-horizontal">

                        {% for form in form_urina_rotina %}
                            {% if forloop.first %}
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">{{ form.leucocitos.label }}</label>
                                    {{ form.leucocitos }}
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">{{ form.hemacias.label }}</label>
                                    {{ form.hemacias }}
                                </div>
                            {% endif %}
                        {% endfor %}

                        {% for exame in exames_analises_microscopica_do_sedimento %}
                            <div class="form-group">
                                <label class="col-sm-2 control-label">{{ exame }}</label>
                                {% for item in item_exame_analises_microscopica_do_sedimento %}
                                    {% if item.exame_id == exame.id %}
                                        <div class="radio-inline">
                                            <label>
                                                <input 
                                                    type="radio" 
                                                    name="item_{{ exame.descricao|replace_nome_exame }}" 
                                                    value="{{ item.id }}"
                                                    {% for item_marcado in exames_marcados %}
                                                        {% if item.id == item_marcado.item_exame.id %}
                                                            checked="checked"
                                                        {% endif %}
                                                    {% endfor %}
                                                > {{ item }}
                                            </label>
                                        </div>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        {% endfor %}

                        {% for form in form_urina_rotina %}
                            {% if forloop.first %}
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">{{ form.cilindros.label }}</label>
                                    {{ form.cilindros }}
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">{{ form.cristais.label }}</label>
                                    {{ form.cristais }}
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">{{ form.parasitas.label }}</label>
                                    {{ form.parasitas }}
                                </div>
                            {% endif %}
                        {% endfor %}

                    </div>
                </div>
            </div>
        </div>

        {# Botão Salvar #}
        <div class="text-right">
            <button type="submit" class="btn btn-success btn-lg">
                <span class="glyphicon glyphicon-floppy-saved" aria-hidden="true"></span>
                Atualizar Laudo
            </button>
        </div>
    </form>

{% endblock content %}